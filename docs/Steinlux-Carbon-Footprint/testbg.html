<!DOCTYPE html>
<html lang="zh-Hant">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>背景測試</title>
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="css/story.css" />
    <style>
    /*—— 自訂字體 ——*/
    @font-face {
    font-family: "GenSenRounded2TW-R";
    src: url("../font/GenSenRounded2TW-R.otf") format("opentype");
    font-weight: normal;
    font-style: normal;
    font-display: swap;
    }
    @font-face {
    font-family: "GenSenRounded2TW-L";
    src: url("../font/GenSenRounded2TW-L.otf") format("opentype");
    font-weight: normal;
    font-style: normal;
    font-display: swap;
    }

    html {
    font-size: 16px;
    margin: 0;
    padding: 0;
    height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
    background: url("images/1-2.png") no-repeat center center fixed;
    background-size: cover;
    font-family: "SweiXDPearlCJKtc-DemiLight", sans-serif;
    }

    @media (min-width: 1440px) {
    html {
        font-size: 18px;
    }
    }

    @media (max-width: 1200px) {
    html {
        font-size: 16px;
    }
    }

    @media (max-width: 768px) {
    html {
        font-size: 15px;
    }
    }

    @media (max-width: 480px) {
    html {
        font-size: 14px;
    }
    }

    /* 全局和版面 */
    body {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    font-size: 1rem;
    letter-spacing: 6px;
    overflow-x: hidden;
    overflow-y: auto;
    }

    .scene {
    position: relative;
    display: none;
    flex-direction: column;
    align-items: center;
    width: 900px;
    max-width: 90%;
    padding: 20px;
    min-height: 500px;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 72px;
    -webkit-backdrop-filter: blur(10px);
    backdrop-filter: blur(10px);
    text-align: center;
    transition: transform .05s ease-in-out;
    z-index: 1;
    }

    .scene::before {
    content: "";
    position: absolute;
    inset: 0;
    -webkit-box-shadow:
    inset -7px -5.25px 2px -6.5px rgba(255, 255, 255), 
    inset 7px 5.25px 2px -6.5px rgb(255, 255, 255),
    inset -2.25px -8px 2px -6.75px rgb(255, 255, 255), 
    inset 2.25px 8px 2px -6.75px rgb(255, 255, 255),
    4px 8px 32px 0px rgba(110, 110, 110, 0.25);
    box-shadow:
    inset -7px -5.25px 2px -6.5px rgba(255, 255, 255), 
    inset 7px 5.25px 2px -6.5px rgb(255, 255, 255),
    inset -2.25px -8px 2px -6.75px rgb(255, 255, 255), 
    inset 2.25px 8px 2px -6.75px rgb(255, 255, 255),
    4px 8px 32px 0px rgba(110, 110, 110, 0.25);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    z-index: -1;
    border-radius: 72px;
    }

    .scene.active {
    display: flex;
    z-index: 1;
    }

    .scene.active .entertain-grid,
    .scene.active .diet-grid, 
    .scene.active .food-grid,
    .scene.active .transport-grid,
    .scene.active .entertain-card,
    .scene.active .home-card,
    .scene.active .travel-card,
    .scene.active .daily-card,
    .scene.active .waste-container,
    .scene.active .template-wrapper{
    animation: slideIn 0.5s ease forwards;
    z-index: 1;
    }

    .slideContainer {
    display: flex;
    flex-direction: column;
    align-items: center;
    width: 100%;
    padding: 0.5rem;
    overflow-y: visible;
    overflow-x: hidden;
    }

    @keyframes slideIn {
    from {
        transform: translateX(100%);
        opacity: 0;
    }
    to {
        transform: translateX(0%);
        opacity: 1;
    }
    }

    h1 {
    font-size: 1.5rem;
    color: #6c808f;
    font-family: "GenSenRounded2TW-R", sans-serif;
    font-weight: 400;
    letter-spacing: 10px;
    text-shadow: #7f7f7f40 2pt 2pt 3pt;
    margin: 0.5rem 0;
    }

    /* 切換開關 */
    .chapter-bar {
    display: none;
    position: relative;
    width: fit-content;
    height: fit-content;
    background-color: rgba(255, 255, 255, 0.05);
    padding: 0.4rem;;
    margin-top: 0.25rem;
    border-radius: 32px;
    justify-content: space-around;
    align-items: center;
    filter: drop-shadow(-8px -10px 46px #00000010);
    -webkit-backdrop-filter:brightness(1.05) blur(2px) url(#displacementFilter);;
    backdrop-filter:brightness(1.05) blur(2px) url(#displacementFilter);;
    z-index: 0;
    }

    .chapter-bar::before {
    content: "";
    position: absolute;
    inset: 0;
    -webkit-box-shadow:
    inset -8.5px -2.25px 0 -7px rgb(255, 255, 255), 
    inset 8.5px 2.25px 0 -7px rgb(255, 255, 255),
    inset -2.75px -8.5px 0 -7.25px rgb(255, 255, 255), 
    inset 2.75px 8.5px 0 -7.25px rgb(255, 255, 255),
    2px 2px 12px 4px rgba(110, 110, 110, 0.15);
    box-shadow:
    inset -8.75px -4.5px 0 -7px rgb(255, 255, 255), 
    inset 8.75px 4.5px 0 -7px rgb(255, 255, 255),
    inset -2.75px -8.5px 0 -7.25px rgb(255, 255, 255), 
    inset 2.75px 8.5px 0 -7.25px rgb(255, 255, 255),
    2px 2px 12px 4px rgba(110, 110, 110, 0.15);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    z-index: 0;
    border-radius: 32px;
    }

    .chapter-button {
    position: relative;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    color: #6D808F;
    text-decoration: none;
    scale: 0.95;
    padding: 0.15rem 1.5rem;
    transition: background-color 0.3s ease;
    border-radius: 96px;
    text-wrap: nowrap;
    z-index: 999;
    }

    .chapter-button.active {
    background-color: rgba(255, 255, 255, 0.35);
    border: solid 1.5px #dddddd80;
    }


    .chapter-button:hover {
    background-color: rgba(255, 255, 255, 0.5);;
    cursor: pointer;
    }

    .chapter-icon {
    font-size: 1rem;
    line-height: 1;
    }

    .chapter-label {
    font-size: 0.6rem;
    margin-top: 2px;
    }

    @media (min-width: 901px) {
    .chapter-bar.show {
        display: flex;
    }
    }

    /* 碳排圓環 */
    .carbon-ring-container {
    position: fixed;
    top: 10px;
    left: 10px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-content: center;
    text-align: center;
    }
    .carbon-ring {
    width: 200px;
    height: 200px;
    }

    .carbon-ring svg {
    transform: rotate(-112.5deg); /* 把缺角轉到左邊中間 (360 - 45)/2 */
    }

    .carbon-ring .text {
    position: absolute;
    top: 45%;
    left: 50%;
    transform: translate(-50%, -50%);
    color: #333;
    line-height: 1.3;
    }

    /* 跳轉橫槓 */

    .page-indicator {
    display: flex;
    justify-content: center;
    align-items: baseline;
    width: 100%;
    margin: 1rem 0 1.5rem 0;
    }

    .bar-container {
    display: flex;
    align-items: center;
    width: 60%;
    gap: 1rem;
    }

    @media (max-width: 768px) {
    h1 {
        margin: 0.5rem 0 1.25rem ;
    }
    .page-indicator {
        display: none;
    }

    .bar-container {
        width: 80%;
    }
    }

    .bar-hit-area {
    display: flex;
    flex: 1;
    padding: 12px;
    margin: -12px; /* 抵銷外推影響布局 */
    cursor: pointer;
    }

    .bar-hit-area:hover .bar {
    background-color: #b5c1c6;
    box-shadow: 1pt 1pt 4pt #7f7f7f60, -2pt -2pt 3pt #ffffff55;
    }

    .bar {
    flex: 1;
    height: 5px;
    background-color: #e4ecf1;
    transition: background-color 0.3s;
    cursor: pointer;
    }

    .bar.active {
    background-color: #b5c1c6;
    box-shadow: 1pt 1pt 4pt #7f7f7f60, -2pt -2pt 3pt #ffffff55;
    }

    /* 換頁按鈕 */

    .nav-btn {
    position: fixed;
    top: 50%;
    transform: translateY(-50%);
    width: 64px;
    height: 64px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 2.5rem;
    color: #b5c1c6;
    background: rgba(255, 255, 255, 0.15);
    border-radius: 50%;
    border: none;
    cursor: pointer;
    backdrop-filter: blur(4px);
    z-index: 1000;
    user-select: none;
    }

    .nav-btn::before {
    content: "";
    position: absolute;
    inset: 0;
    -webkit-box-shadow:
    inset -0.185rem -0.235rem 0.315rem -0.295rem rgba(255, 255, 255), 
    inset 0.185rem 0.25rem 0.315rem -0.295rem rgba(255, 255, 255),
    -0.06rem -0.03rem 0 0 rgba(255, 255, 255), 
    0.03rem 0.03rem 0 0 rgba(255, 255, 255);
    box-shadow:
    inset -0.285rem -0.235rem 0.1rem -0.295rem rgba(255, 255, 255), 
    inset 0.285rem 0.235rem 0.1rem -0.295rem rgba(255, 255, 255),
    -0.03rem -0.025rem 0 0 rgba(255, 255, 255), 
    0.025rem 0.025rem 0 0 rgba(255, 255, 255),
    4px 16px 48px 8px rgba(110, 110, 110, 0.15);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    z-index: -1;
    border-radius: 50%;
    }

    .nav-btn::after {
    content: "";
    position: absolute;
    inset: 0;
    background: radial-gradient(circle at center,#ffffff, #eff3f910);
    opacity: 0;
    transition: opacity 0.25s ease;
    border-radius: 50%;
    z-index: -1;
    }

    .nav-btn:hover::after {
    opacity: 1;
    }

    .prev-btn {
    left: -100px;
    }
    .next-btn {
    right: -100px;
    }

    @media (max-width: 1200px) {
    .nav-btn {
        scale: 0.9;
    }
    .prev-btn {
        left: 8px;
    }
    .next-btn {
        right: 8px;
    }
    }

    @media (max-width: 900px) {
    .nav-btn {
        scale: 0.8;
    }
    .prev-btn {
        left: 4px;
    }
    .next-btn {
        right: 4px;
    }
    }

    @media (max-width: 600px) {
    .nav-btn {
        scale: 0.5;
    }
    .prev-btn {
        left: -12px;
    }
    .next-btn {
        right: -12px;
    }
    }

    /* 切換開關 */

    @keyframes switchOn {
    0% {
        transform: translateX(0px);
    }
    20% {
        transform: translateX(10px);
    }
    40% {
        transform: translateX(20px);
    }
    60% {
        transform: translateX(21px);
    }
    80% {
        transform: translateX(19px);
    }
    100% {
        transform: translateX(20px);
        box-shadow: #ffffff 0;
    }
    }

    @keyframes switchOff {
    0% {
        transform: translateX(20px);
    }
    20% {
        transform: translateX(10px);
    }
    40% {
        transform: translateX(0px);
    }
    60% {
        transform: translateX(-1px);
    }
    80% {
        transform: translateX(1px);
    }
    100% {
        transform: translateX(0px);
    }
    }

    .toggle-switch {
    position: relative;
    min-width: 40px;
    min-height: 20px;
    margin: 2px;
    }

    .toggle-switch input {
    opacity: 0;
    width: 0;
    height: 0;
    }

    .toggle-switch .slider {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: #eff3f9;
    border: none;
    box-shadow: 2pt 2.5pt 3pt #6d808f50 inset;
    border-radius: 10px;
    transition: 0.75s;
    }

    .toggle-switch .slider:before {
    position: absolute;
    content: "";
    height: 16px;
    width: 16px;
    left: 2px;
    bottom: 2px;
    background: #fff;
    border-radius: 50%;
    transition: 0.3s;
    box-shadow: -4pt -4pt 5pt #ffffff46, 5pt 5pt 10pt #c3cadb76;
    }

    .toggle-switch input:checked + .slider {
    background: #d0d2d6;
    }

    .toggle-switch input:checked + .slider:before {
    animation: switchOn .5s linear forwards;
    }

    .toggle-switch input:not(:checked) + .slider:before {
    animation: switchOff 0.5s linear forwards;
    }


    /* input 框樣式 */
    .custom-number-input input[type="number"],
    .modal-body .input-group input[type="number"],
    .toggle-card input[type="number"],
    .fashion-box input[type="number"] {
    padding: 4px 8px;
    background: #fff;
    color: #4a4a4a;
    text-align: center;
    min-width: 40px;
    max-width: 80px;
    height: 24px;
    border: 0.25pt solid #b5c1c623;
    border-radius: 16px;
    box-shadow: inset 1pt 1pt 4pt #6d808f70;
    outline: none;
    }

    .custom-number-input {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    }

    .custom-number-input input[type="number"]::-webkit-inner-spin-button,
    .custom-number-input input[type="number"]::-webkit-outer-spin-button {
    -webkit-appearance: none;
    margin: 0;
    }

    .custom-number-input button {
    position: relative;
    display: flex;
    justify-content: center;
    align-items: center;
    background: none;
    border: none;
    border-radius: 100%;
    background: rgba(255, 255, 255);
    box-shadow: -4pt -4pt 5pt #ffffff46, 5pt 5pt 10pt #c3cadb76;
    width: 20px;
    height: 20px;
    padding: 12px;
    font-size: 1rem;
    color: #b5c1c6;
    font-weight: 600;
    cursor: pointer;
    user-select: none;
    transition: background-color 0.2s;
    }

    .custom-number-input button:hover {
    background-color: #ddd;
    }

    .custom-number-input .btn-decrement {
    position: relative;
    font-size: 1.5rem;
    }

    .custom-number-input .btn-decrement .decrement {
    position: absolute;
    top: 40%;
    left: 50%;
    transform: translate(-50%, -50%);
    }

    /* Info 按鈕 */
    .info-btn {
    position: absolute;
    bottom: 48px;
    right: 32px;
    width: 32px;
    height: 32px;
    border-radius: 50%;
    background: radial-gradient(
        circle at 30% 30%,
        rgba(255, 255, 255, 0.9) 0%,
        rgba(236, 240, 245, 1) 100%
    );
    -webkit-box-shadow:
    inset -0.185rem -0.235rem 0.315rem -0.295rem rgba(255, 255, 255), 
    inset 0.185rem 0.25rem 0.315rem -0.295rem rgba(255, 255, 255),
    -0.06rem -0.03rem 0 0 rgba(255, 255, 255), 
    0.03rem 0.03rem 0 0 rgba(255, 255, 255);
    box-shadow:
    inset -0.285rem -0.235rem 0.1rem -0.295rem rgba(255, 255, 255), 
    inset 0.285rem 0.235rem 0.1rem -0.295rem rgba(255, 255, 255),
    -0.03rem -0.025rem 0 0 rgba(255, 255, 255), 
    0.025rem 0.025rem 0 0 rgba(255, 255, 255),
    4px 8px 16px 0 rgba(110, 110, 110, 0.15);
    display: flex;
    align-items: center;
    justify-content: center;
    border: none;
    cursor: pointer;
    z-index: 10;
    }

    .info-btn img {
    width: 20px;
    height: 20px;
    object-fit: contain;
    }

    /* Modal */
    .modal {
    display: none;
    justify-content: center;
    align-items: center;
    position: fixed;
    bottom: 24px;
    right: -8px;
    transform: translate(-50%, -50%);
    width: fit-content;
    height: 16px;
    -webkit-box-shadow:
    inset -0.185rem -0.235rem 0.315rem -0.295rem rgba(255, 255, 255), 
    inset 0.185rem 0.25rem 0.315rem -0.295rem rgba(255, 255, 255),
    -0.06rem -0.03rem 0 0 rgba(255, 255, 255), 
    0.03rem 0.03rem 0 0 rgba(255, 255, 255);
    box-shadow:
    inset -0.285rem -0.235rem 0.1rem -0.295rem rgba(255, 255, 255), 
    inset 0.285rem 0.235rem 0.1rem -0.295rem rgba(255, 255, 255),
    -0.03rem -0.05rem 0 0 rgba(255, 255, 255), 
    0.125rem 0.05rem 0 0 rgba(255, 255, 255),
    4px 8px 16px 0 rgba(110, 110, 110, 0.15);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    border-radius: 16px;
    padding: 0.75rem;
    z-index: 1000;
    }
    .modal-close {
    position: absolute;
    top: 0;
    right: 4px;
    color: #aaa;
    cursor: pointer;
    user-select: none;
    }
    .modal-close:hover {
    color: #333;
    }

    /* Modal 內容排版 */
    .modal-body {
    font-size: 0.75rem;
    flex: 1;
    overflow-y: auto;
    white-space: nowrap;
    }

      #pane-left, #pane-right, #pane-left4, #pane-right4 {
        animation: none;
      }

      .hidden {
        display: none;
      }

      .inactive {
          opacity: 0.4;
          transition: all 0.3s ease;
          pointer-events: none;
      }

      /* ---------------------------------------
       4. 交通工具選單
    --------------------------------------- */
      .transport-grid {
        display: grid;
        grid-template-columns: repeat(3, minmax(120px, 1fr));
        grid-template-rows: repeat(2, auto);
        gap: 1rem;
        width: 90%;
        max-width: 700px;
        margin: 0 auto;
      }
      .transport-card {
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        background: rgba(255, 255, 255, 0);
        border-radius: 32px;
        cursor: pointer;
        transition: transform 0.2s, border-color 0.2s;
      }
      .transport-card img {
        width: 120px;
        height: 120px;
        object-fit: contain;
        margin-bottom: -10px;
      }

      .transport-card .label {
        font-family: "GenSenRounded2TW-R", sans-serif;
        font-size: 1.2rem;
        color: #6d808f;
        text-align: center;
        white-space: nowrap;
        letter-spacing: 6px;
      }

      .transport-card:hover {
        transform: translateY(-2px);
      }
      
      .transport-card.selected {
      -webkit-box-shadow:
      inset -7.5px -4.75px 1px -6.5px rgb(255, 255, 255), 
      inset 7.5px 4.75px 1px -6.5px rgb(255, 255, 255),
      inset -1.75px -7.5px 1px -6.75px rgb(255, 255, 255), 
      inset 1.75px 7.5px 1px -6.75px rgb(255, 255, 255),
      2px 4px 16px 0px rgba(110, 110, 110, 0.275);
      box-shadow:
      inset -7px -4.75px 1px -6.5px rgb(255, 255, 255), 
      inset 7px 4.75px 1px -6.5px rgb(255, 255, 255),
      inset -1.75px -7px 1px -6.75px rgb(255, 255, 255), 
      inset 1.75px 7px 1px -6.75px rgb(255, 255, 255),
      2px 4px 16px 0px rgba(110, 110, 110, 0.275);
      }
      
      /* ---------------------------------------
       5. 切換開關區塊 (Scene 2 & 4)
    --------------------------------------- */
      .toggle-row {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 10px;
      }

      .daily-card {
        display: flex;
        justify-content: center;
        flex-wrap: wrap;
        width: 100%;
        gap: 1.25rem;
      }

      .toggle-card {
        display: flex;
        align-items: center;
        width: 40%;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 32px;
        padding: 1rem 1.25rem;
        gap: 0.75rem;
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
      }

      .toggle-card::before {
      content: "";
      position: absolute;
      inset: 0;
      -webkit-box-shadow:
      inset -8.5px -2.25px 0 -6.75px rgb(255, 255, 255), 
      inset 8.5px 2.25px 0 -6.75px rgb(255, 255, 255),
      inset -2.75px -8.5px 0 -7px rgb(255, 255, 255), 
      inset 2.75px 8.5px 0 -7px rgb(255, 255, 255),
      2px 2px 12px 0px rgba(110, 110, 110, 0.15);
      box-shadow:
      inset -8.5px -2.25px 0 -6.75px rgb(255, 255, 255), 
      inset 8.5px 2.25px 0 -6.75px rgb(255, 255, 255),
      inset -2.75px -8.5px 0 -7px rgb(255, 255, 255), 
      inset 2.75px 8.5px 0 -7px rgb(255, 255, 255),
      2px 2px 12px 0px rgba(110, 110, 110, 0.15);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      z-index: -1;
      border-radius: 32px;
      }

      .toggle-card span.label {
        font-family: "GenSenRounded2TW-R", sans-serif;
        color: #9c7a5c;
        line-height: 1.2;
        white-space: nowrap;
      }

      .nowrap-text {
        color: #6c808f;
        white-space: nowrap;
        font-family: "GenSenRounded2TW-L", sans-serif;
        letter-spacing: 6px;
      }


      /* ---------------------------------------
       6. 動態模板區域 (Scene 2 & 4)
    --------------------------------------- */
      .template-wrapper {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      width: 40%;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 32px;
      padding: 1.25rem;
      gap: 1rem;
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      }

      .template-wrapper::before {
      content: "";
      position: absolute;
      inset: 0;
      -webkit-box-shadow:
      inset -8.5px -2.25px 0 -6.75px rgb(255, 255, 255), 
      inset 8.5px 2.25px 0 -6.75px rgb(255, 255, 255),
      inset -2.75px -8.5px 0 -7px rgb(255, 255, 255), 
      inset 2.75px 8.5px 0 -7px rgb(255, 255, 255),
      2px 2px 12px 0px rgba(110, 110, 110, 0.15);
      box-shadow:
      inset -8.5px -2.25px 0 -6.75px rgb(255, 255, 255), 
      inset 8.5px 2.25px 0 -6.75px rgb(255, 255, 255),
      inset -2.75px -8.5px 0 -7px rgb(255, 255, 255), 
      inset 2.75px 8.5px 0 -7px rgb(255, 255, 255),
      2px 2px 12px 0px rgba(110, 110, 110, 0.15);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      z-index: -1;
      border-radius: 32px;
      }

      .template-row {
        display: flex;
        gap: 32px;
        justify-content: center;
      }

      .fuel-group .input-group {
        display: flex;
        align-items: center;
        padding: 1rem 0.75rem;
        gap: 0.5rem;
      }
      
      .fuel-group .input-group label {
        font-family: "GenSenRounded2TW-R", sans-serif;
        font-size: 1rem;
        color: #9c7a5c;
        letter-spacing: 4px;
        white-space: nowrap;
      }

      .fuel-group .input-group input {
        font-family: "GenSenRounded2TW-L", sans-serif;
        width: 100px;
        padding: 8px 10px;
        border: 0.25pt solid #b5c1c623;
        border-radius: 8px;
        box-shadow: inset 2pt 2pt 7pt #6d808f70;
        background: #fff;
        font-size: 14px;
        color: #4a4a4a;
        letter-spacing: 3px;
      }

      .fuel-group .input-group input[type="number"]::-webkit-outer-spin-button,
      .fuel-group .input-group input[type="number"]::-webkit-inner-spin-button,
      .input-group-MRT input[type="number"]::-webkit-outer-spin-button,
      .input-group-MRT input[type="number"]::-webkit-inner-spin-button {
        -webkit-appearance: none;
        margin: 0;
      }

      .fuel-group .input-group .special-label {
      font-family: "GenSenRounded2TW-L", sans-serif;
      font-weight: normal;
      color: #6c808f;
      margin: 0;
      }
      /* ---------------------------------------
       7. MRT區域 (Scene 2 & 4)
    --------------------------------------- */


      .mrt-trip-list-wrapper .mrt-btn {
        flex: 0 0 auto; /* 按鈕不跟著滾動區縮放 */
        margin-top: 20px;
      }

      .input-group-MRT {
        display: flex;
        align-items: center;
        flex-direction: row;
        gap: 0.5rem;
        margin: 0.15rem 0;
      }

      .input-group-MRT label {
        margin: 0.15rem 0.75rem;
        font-size: 0.85rem;
        color: #9c7a5c;
        white-space: nowrap;
        font-family: "GenSenRounded2TW-R", sans-serif;
        letter-spacing: 6px;
      }
      .input-group-MRT .special-label {
        font-family: "GenSenRounded2TW-L", sans-serif;
        font-weight: normal;
        color: #6c808f;
      }

      .input-group-MRT select {
        -webkit-appearance: none;
        -moz-appearance: none;
        appearance: none;
        width: 100px;
        padding: 8px 30px 8px 12px;
        border: 1px solid rgba(208, 210, 214, 0.6);
        border-radius: 6px;
        background: #fff url("images/下拉式箭頭.webp") no-repeat right center;
        background-size: 30px;
        box-shadow: inset 2pt 2pt 7pt #6d808f70;
        font-size: 14px;
        color: #4a4a4a;
      }

      .input-group-MRT input {
        width: 120px;
        padding: 0.375rem 0.675rem;
        border: 0.25pt solid #b5c1c623;
        border-radius: 6px;
        background: #fff;
        font-size: 14px;
        color: #4a4a4a;
        box-shadow: inset 2pt 2pt 7pt #6d808f70;
        font-family: "GenSenRounded2TW-L", sans-serif;
        letter-spacing: 2px;
      }

      #mrtTripDisplay {
        display: flex;
        flex-direction: column;
      }

      .mrt-btn {
        width: 50%;
        margin: auto 0 0.25rem;
        align-self: center;
        background: rgba(240, 244, 252, 0.8);
        backdrop-filter: blur(8px);
        -webkit-backdrop-filter: blur(8px);
        border: 1px solid rgba(255, 255, 255, 0.6);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        border-radius: 32px;
        font-size: 0.85rem;
        font-weight: bold;
        color: rgba(0, 0, 0, 0.2);
        text-shadow: 0 1px 2px rgba(255, 255, 255, 0.8);
        padding: 6px 12px;
        cursor: pointer;
        transition: background-color 0.2s, box-shadow 0.2s;
        font-family: "GenSenRounded2TW-R", sans-serif;
      }

      .mrt-btn:hover {
        background-color: rgba(240, 244, 252, 1);
        box-shadow: 0 6px 16px rgba(0, 0, 0, 0.1);
      }

      /* trip-list */
      .mrt-trip-list-wrapper {
        display: flex;
        flex-direction: column;
        height: 200px;
      }

      .trip-list {
        flex: 1;
        display: flex;
        flex-direction: column;
        justify-content: start;
        align-items: center;
        max-width: 100%;
        min-width: 100%;
        width: 100%;
        max-height: 200px;
        overflow-x: hidden;
        overflow-y: auto;
      }
      
      /* trip-list */
      .trip-item {
        display: flex;
        justify-content: center;
        min-width: 100%;
        width: 100%;
        font-size: 0.9rem;
        color: #6c808f;
        margin: 0.25rem;
        padding: 12px;
        border: 2px solid #e5e7eb;
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.3s ease;
        user-select: none;
        position: relative;
      }

    .trip-item:hover {
      border-color: #3b82f6;
      background-color: #f8fafc;
      transform: translateY(-1px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }
    
    .trip-item.selected {
      border-color: #10b981;
      background-color: #ecfdf5;
      color: #047857;
      box-shadow: 0 4px 12px rgba(16, 185, 129, 0.2);
    }
    
    .trip-item.selected:hover {
      border-color: #ef4444;
      background-color: #fef2f2;
      color: #dc2626;
      box-shadow: 0 4px 12px rgba(239, 68, 68, 0.2);
    }
    
    .trip-item::before {
      content: '';
      width: 20px;
      height: 20px;
      border: 2px solid #d1d5db;
      border-radius: 50%;
      margin-right: 12px;
      flex-shrink: 0;
      transition: all 0.3s ease;
      position: relative;
      background-color: white;
    }
    
    .trip-item:hover::before {
      border-color: #3b82f6;
    }
    
    .trip-item.selected::before {
      border-color: #10b981;
      background-color: #10b981;
      background-image: url("data:image/svg+xml,%3csvg viewBox='0 0 16 16' fill='white' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='m13.854 3.646-7.5 7.5a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6 10.293l7.146-7.147a.5.5 0 0 1 .708.708z'/%3e%3c/svg%3e");
      background-size: 12px 12px;
      background-position: center;
      background-repeat: no-repeat;
    }
    
    .trip-item.selected:hover::before {
      border-color: #ef4444;
      background-color: #ef4444;
      background-image: url("data:image/svg+xml,%3csvg viewBox='0 0 16 16' fill='white' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z'/%3e%3c/svg%3e");
    }
    
    .trip-item.selected::after {
      content: '點擊取消選擇';
      position: absolute;
      top: -4px;
      right: 12px;
      background-color: #ef4444;
      color: white;
      padding: 2px 6px;
      border-radius: 4px;
      font-size: 10px;
      opacity: 0;
      transform: translateY(-5px);
      transition: all 0.3s ease;
      pointer-events: none;
      z-index: 10;
    }
    
    .trip-item.selected:hover::after {
      opacity: 1;
      transform: translateY(0);
    }
    
    .trip-item-text {
      flex: 1;
    }

    .selection-info {
      margin: 8px 0;
      padding: 8px 12px;
      background-color: #f1f5f9;
      border-radius: 6px;
      font-size: 12px;
      color: #475569;
      border-left: 3px solid #3b82f6;
    }
    
    .selection-info.has-selection {
      background-color: #ecfdf5;
      border-left-color: #10b981;
      color: #047857;
    }

      .add-trip-wrapper {
      display: flex;
      justify-content: center;
      align-items: flex-start;
      align-content: center;
      flex-direction: column;
      }

      .mrt-btn {
        width: 50%;
        margin: auto 0 0.25rem;
        align-self: center;
        background: rgba(240, 244, 252, 0.8);
        backdrop-filter: blur(8px);
        -webkit-backdrop-filter: blur(8px);
        border: 1px solid rgba(255, 255, 255, 0.6);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        border-radius: 32px;
        font-size: 0.85rem;
        font-weight: bold;
        color: rgba(0, 0, 0, 0.2);
        text-shadow: 0 1px 2px rgba(255, 255, 255, 0.8);
        padding: 6px 12px;
        cursor: pointer;
        transition: background-color 0.2s, box-shadow 0.2s;
        font-family: "GenSenRounded2TW-R", sans-serif;
      }

      /* 2. 滑鼠懸停效果（選填） */
      .mrt-btn:hover {
        background: rgba(240, 244, 252, 1);
        box-shadow: 0 6px 16px rgba(0, 0, 0, 0.1);
      }
      #scene7 .template-wrapper {
        width: 750px;
        max-width: 100%;
        height: 200px;
        justify-content: center;
        overflow-y: auto;
        margin: auto 0;
        align-items: center;
      }
      #scene7 .add-trip-wrapper {
        gap: 12px;
      }
    </style>
  </head>

  <body>
    <!-- Scene 1: 選車種 -->
    <section id="scene-daily-1" class="scene scene-1 active">
<div class="chapter-bar show">
  <div class="chapter-button" onclick="changeBackground('images/1-2.png')">
    <div class="chapter-icon"><i class="fa-solid fa-car-side"></i></div>
    <div class="chapter-label">圖一</div>
  </div>
    <div class="chapter-button" onclick="changeBackground('images/1-3.png')">
    <div class="chapter-icon"><i class="fa-solid fa-house-chimney"></i></div>
    <div class="chapter-label">圖二</div>
  </div>
  <div class="chapter-button" onclick="changeBackground('images/1-4.png')">
    <div class="chapter-icon"><i class="fa-solid fa-plane-departure"></i></div>
    <div class="chapter-label">圖三</div>
  </div>
  <div class="chapter-button" onclick="changeBackground('images/bg2.webp')">
    <div class="chapter-icon"><i class="fa-solid fa-drumstick-bite"></i></div>
    <div class="chapter-label">圖四</div>
  </div>
  <div class="chapter-button" onclick="changeBackground('images/bg3.webp')">
    <div class="chapter-icon"><i class="fa-solid fa-shirt"></i></div>
    <div class="chapter-label">圖五</div>
  </div>
  <div class="chapter-button" onclick="changeBackground('images/bg4.webp')">
    <div class="chapter-icon"><i class="fa-solid fa-wifi"></i></div>
    <div class="chapter-label">圖六</div>
  </div>
  <div class="chapter-button" onclick="changeBackground('images/bg5.webp')">
    <div class="chapter-icon"><i class="fa-solid fa-star"></i></div>
    <div class="chapter-label">圖七</div>
  </div>
  <div class="chapter-button" onclick="changeBackground('images/bg6.webp')">
    <div class="chapter-icon"><i class="fa-solid fa-star"></i></div>
    <div class="chapter-label">圖八</div>
  </div>
</div>
      <div class="slideContainer">
      <h1>日常通勤使用的交通工具</h1>
        <div class="page-indicator">
          <div class="bar-container dynamic-bar-container"></div>
        </div>
        <div class="transport-grid">
          <div class="transport-card" onclick="toggleActivity(this,'汽車')">
            <img src="images/汽車.webp" alt="汽車" />
            <span class="label">汽車</span>
          </div>
          <div class="transport-card" onclick="toggleActivity(this,'機車')">
            <img src="images/機車.webp" alt="機車" />
            <span class="label">機車</span>
          </div>
          <div class="transport-card" onclick="toggleActivity(this,'公車')">
            <img src="images/公車.webp" alt="公車" />
            <span class="label">公車</span>
          </div>
          <div class="transport-card" onclick="toggleActivity(this,'捷運')">
            <img src="images/捷運.webp" alt="捷運" />
            <span class="label">捷運</span>
          </div>
          <div class="transport-card" onclick="toggleActivity(this,'火車')">
            <img src="images/火車.webp" alt="火車" />
            <span class="label">火車</span>
          </div>
          <div class="transport-card" onclick="toggleActivity(this,'高鐵')">
            <img src="images/高鐵.webp" alt="高鐵" />
            <span class="label">高鐵</span>
          </div>
        </div>
      </div>
      <button class="nav-btn prev-btn"  onclick="window.location.href='index.html'">‹</button>
      <button class="nav-btn next-btn" onclick="handleFirstSceneNext()">›</button>
    </section>

    <!-- Scene 1: 燃料 & 計算方法 -->
    <section id="scene-daily-2-1" class="scene">
<div class="chapter-bar show">
  <div class="chapter-button" onclick="changeBackground('images/圖片\ 1.webp')">
    <div class="chapter-icon"><i class="fa-solid fa-car-side"></i></div>
    <div class="chapter-label">圖一</div>
  </div>
    <div class="chapter-button" onclick="changeBackground('images/background.webp')">
    <div class="chapter-icon"><i class="fa-solid fa-house-chimney"></i></div>
    <div class="chapter-label">圖二</div>
  </div>
  <div class="chapter-button" onclick="changeBackground('images/bg1.webp')">
    <div class="chapter-icon"><i class="fa-solid fa-plane-departure"></i></div>
    <div class="chapter-label">圖三</div>
  </div>
  <div class="chapter-button" onclick="changeBackground('images/bg2.webp')">
    <div class="chapter-icon"><i class="fa-solid fa-drumstick-bite"></i></div>
    <div class="chapter-label">圖四</div>
  </div>
  <div class="chapter-button" onclick="changeBackground('images/bg3.webp')">
    <div class="chapter-icon"><i class="fa-solid fa-shirt"></i></div>
    <div class="chapter-label">圖五</div>
  </div>
  <div class="chapter-button" onclick="changeBackground('images/bg4.webp')">
    <div class="chapter-icon"><i class="fa-solid fa-wifi"></i></div>
    <div class="chapter-label">圖六</div>
  </div>
  <div class="chapter-button" onclick="changeBackground('images/bg5.webp')">
    <div class="chapter-icon"><i class="fa-solid fa-star"></i></div>
    <div class="chapter-label">圖七</div>
  </div>
  <div class="chapter-button" onclick="changeBackground('images/bg6.webp')">
    <div class="chapter-icon"><i class="fa-solid fa-star"></i></div>
    <div class="chapter-label">圖八</div>
  </div>
</div>
      <div class="slideContainer">
        <h1>汽車使用狀況</h1>
        <div class="page-indicator">
          <div class="bar-container dynamic-bar-container"></div>
        </div>
        <div class="daily-card">
          <!-- 燃料開關 -->
          <div class="toggle-card">
            <span class="label">選擇<br />車種燃料</span>
            <div class="toggle-row">
              <span class="nowrap-text">油車</span>
              <label class="toggle-switch">
                <input type="checkbox" id="fuelToggle" />
                <span class="slider"></span>
              </label>
              <span class="nowrap-text">電車</span>
            <div>
          </div>
            </div>
          </div>
          <!-- 方法開關 -->
          <div class="toggle-card">
            <span class="label">選擇<br />計算方法</span>
            <div class="toggle-row">
              <span class="nowrap-text">距離</span>
              <label class="toggle-switch">
                <input type="checkbox" id="methodToggle" />
                <span class="slider"></span>
              </label>
              <span class="nowrap-text">油量</span>
            </div>
          </div>

          <div id="pane-left" class="template-wrapper">
            <div id="oil-left" class="fuel-group">
              <div class="input-group">
                <label>選擇<br />汽油類型</label>
                <input list="car-oilList" id="oilInput" />
                <datalist id="car-oilList"></datalist>
              </div>
              <div class="input-group">
                <label>每週加油</label>
                <input type="number" />
                <label class="special-label">元 / 週</label>
              </div>
            </div>
            <div id="electric-left" class="fuel-group hidden">
              <div class="input-group">
                <label>行駛里程</label>
                <input type="number" />
                <label class="special-label">公里 / 週</label>
              </div>
            </div>
          </div>

          <div id="pane-right" class="template-wrapper inactive">
            <div id="oil-right" class="fuel-group">
              <div class="input-group">
                <label>選擇<br />汽車類型</label>
                <input list="carList" id="carInput" />
                <datalist id="carList"></datalist>
              </div>
              <div class="input-group">
                <label>每週行駛</label>
                <input type="number" />
                <label class="special-label">公里 / 週</label>
              </div>
            </div>
            <div id="electric-right" class="fuel-group hidden">
              <div class="input-group">
                <label>外出充電</label>
                <input type="number" />
                <label class="special-label">kWh / 週</label>
              </div>
            </div>
          </div>
          </div>
        </div>
      </div>

      <button class="nav-btn prev-btn" onclick="goToPrevScene()">‹</button>
      <button class="nav-btn next-btn" onclick="goToNextScene()">›</button>
    </section>
    <!-- Scene 2: 燃料 & 計算方法（機車） -->
    <section id="scene-daily-2-2" class="scene">
<div class="chapter-bar show">
  <div class="chapter-button" onclick="changeBackground('images/圖片\ 1.webp')">
    <div class="chapter-icon"><i class="fa-solid fa-car-side"></i></div>
    <div class="chapter-label">圖一</div>
  </div>
    <div class="chapter-button" onclick="changeBackground('images/background.webp')">
    <div class="chapter-icon"><i class="fa-solid fa-house-chimney"></i></div>
    <div class="chapter-label">圖二</div>
  </div>
  <div class="chapter-button" onclick="changeBackground('images/bg1.webp')">
    <div class="chapter-icon"><i class="fa-solid fa-plane-departure"></i></div>
    <div class="chapter-label">圖三</div>
  </div>
  <div class="chapter-button" onclick="changeBackground('images/bg2.webp')">
    <div class="chapter-icon"><i class="fa-solid fa-drumstick-bite"></i></div>
    <div class="chapter-label">圖四</div>
  </div>
  <div class="chapter-button" onclick="changeBackground('images/bg3.webp')">
    <div class="chapter-icon"><i class="fa-solid fa-shirt"></i></div>
    <div class="chapter-label">圖五</div>
  </div>
  <div class="chapter-button" onclick="changeBackground('images/bg4.webp')">
    <div class="chapter-icon"><i class="fa-solid fa-wifi"></i></div>
    <div class="chapter-label">圖六</div>
  </div>
  <div class="chapter-button" onclick="changeBackground('images/bg5.webp')">
    <div class="chapter-icon"><i class="fa-solid fa-star"></i></div>
    <div class="chapter-label">圖七</div>
  </div>
  <div class="chapter-button" onclick="changeBackground('images/bg6.webp')">
    <div class="chapter-icon"><i class="fa-solid fa-star"></i></div>
    <div class="chapter-label">圖八</div>
  </div>
</div>
      <div class="slideContainer">
        <h1>機車使用情況</h1>
        <div class="page-indicator">
          <div class="bar-container dynamic-bar-container"></div>
        </div>
        <div class="daily-card">
          <!-- 燃料開關 -->
          <div class="toggle-card">
            <span class="label">選擇<br />車種燃料</span>
            <div class="toggle-row">
              <span class="nowrap-text">油車</span>
              <label class="toggle-switch">
                <input type="checkbox" id="fuelToggle4" />
                <span class="slider"></span>
              </label>
              <span class="nowrap-text">電車</span>
            </div>
          </div>

          <!-- 方法開關 -->
          <div class="toggle-card">
            <span class="label">選擇<br />計算方法</span>
            <div class="toggle-row">
              <span class="nowrap-text">距離</span>
              <label class="toggle-switch">
                <input type="checkbox" id="methodToggle4" />
                <span class="slider"></span>
              </label>
              <span class="nowrap-text">油量</span>
            </div>
          </div>

          <div id="pane-left4" class="template-wrapper">
            <div id="oil-left4" class="fuel-group">
              <div class="input-group">
                <label>選擇<br />汽油類型</label>
                  <input list="motorcycle-oilList" id="oliInput" />
                  <datalist id="motorcycle-oilList"></datalist>
              </div>
              <div class="input-group">
                <label>每週加油</label>
                <input type="number" />
                <label class="special-label">元 / 週</label>
              </div>
            </div>
            <div id="electric-left4" class="fuel-group hidden">
              <div class="input-group">
                <label>行駛里程</label>
                <input type="number" />
                <label class="special-label">公里 / 週</label>
              </div>
            </div>
          </div>

          <div id="pane-right4" class="template-wrapper inactive">
            <div id="oil-right4" class="fuel-group">
              <div class="input-group">
                <label>每週行駛</label>
                <input type="number" />
                <label class="special-label">公里 / 週</label>
              </div>
            </div>
            <div id="electric-right4" class="fuel-group hidden">
              <div class="input-group">
                <label>外出充電</label>
                <input type="number" />
                <label class="special-label">kWh / 週</label>
              </div>
            </div>
          </div>
        </div>
      </div>

      <button class="nav-btn prev-btn" onclick="goToPrevScene()">‹</button>
      <button class="nav-btn next-btn" onclick="goToNextScene()">›</button>
    </section>
    <!-- 玻璃卡片 -->

    <!-- Scene 3: 公車使用情況 -->
    <section id="scene-daily-2-3" class="scene">
<div class="chapter-bar show">
  <div class="chapter-button" onclick="changeBackground('images/圖片\ 1.webp')">
    <div class="chapter-icon"><i class="fa-solid fa-car-side"></i></div>
    <div class="chapter-label">圖一</div>
  </div>
    <div class="chapter-button" onclick="changeBackground('images/background.webp')">
    <div class="chapter-icon"><i class="fa-solid fa-house-chimney"></i></div>
    <div class="chapter-label">圖二</div>
  </div>
  <div class="chapter-button" onclick="changeBackground('images/bg1.webp')">
    <div class="chapter-icon"><i class="fa-solid fa-plane-departure"></i></div>
    <div class="chapter-label">圖三</div>
  </div>
  <div class="chapter-button" onclick="changeBackground('images/bg2.webp')">
    <div class="chapter-icon"><i class="fa-solid fa-drumstick-bite"></i></div>
    <div class="chapter-label">圖四</div>
  </div>
  <div class="chapter-button" onclick="changeBackground('images/bg3.webp')">
    <div class="chapter-icon"><i class="fa-solid fa-shirt"></i></div>
    <div class="chapter-label">圖五</div>
  </div>
  <div class="chapter-button" onclick="changeBackground('images/bg4.webp')">
    <div class="chapter-icon"><i class="fa-solid fa-wifi"></i></div>
    <div class="chapter-label">圖六</div>
  </div>
  <div class="chapter-button" onclick="changeBackground('images/bg5.webp')">
    <div class="chapter-icon"><i class="fa-solid fa-star"></i></div>
    <div class="chapter-label">圖七</div>
  </div>
  <div class="chapter-button" onclick="changeBackground('images/bg6.webp')">
    <div class="chapter-icon"><i class="fa-solid fa-star"></i></div>
    <div class="chapter-label">圖八</div>
  </div>
</div>
      <div class="slideContainer">
        <h1>公車使用情況</h1>
        <div class="page-indicator">
          <div class="bar-container dynamic-bar-container"></div>
        </div>
        <div class="template-wrapper">
          <div class="input-group-MRT">
            <label for="busCount">每周搭乘</label>
            <input id="busCount" type="number" min="0" />
            <label style="color: #6c808f">公里</label>
          </div>
        </div>
      </div>
      <button class="nav-btn prev-btn" onclick="goToPrevScene()">‹</button>
      <button class="nav-btn next-btn" onclick="goToNextScene()">›</button>
    </section>

    <!-- Scene 4: 捷運使用情況 -->
    <section id="scene-daily-2-4" class="scene">
<div class="chapter-bar show">
  <div class="chapter-button" onclick="changeBackground('images/圖片\ 1.webp')">
    <div class="chapter-icon"><i class="fa-solid fa-car-side"></i></div>
    <div class="chapter-label">圖一</div>
  </div>
    <div class="chapter-button" onclick="changeBackground('images/background.webp')">
    <div class="chapter-icon"><i class="fa-solid fa-house-chimney"></i></div>
    <div class="chapter-label">圖二</div>
  </div>
  <div class="chapter-button" onclick="changeBackground('images/bg1.webp')">
    <div class="chapter-icon"><i class="fa-solid fa-plane-departure"></i></div>
    <div class="chapter-label">圖三</div>
  </div>
  <div class="chapter-button" onclick="changeBackground('images/bg2.webp')">
    <div class="chapter-icon"><i class="fa-solid fa-drumstick-bite"></i></div>
    <div class="chapter-label">圖四</div>
  </div>
  <div class="chapter-button" onclick="changeBackground('images/bg3.webp')">
    <div class="chapter-icon"><i class="fa-solid fa-shirt"></i></div>
    <div class="chapter-label">圖五</div>
  </div>
  <div class="chapter-button" onclick="changeBackground('images/bg4.webp')">
    <div class="chapter-icon"><i class="fa-solid fa-wifi"></i></div>
    <div class="chapter-label">圖六</div>
  </div>
  <div class="chapter-button" onclick="changeBackground('images/bg5.webp')">
    <div class="chapter-icon"><i class="fa-solid fa-star"></i></div>
    <div class="chapter-label">圖七</div>
  </div>
  <div class="chapter-button" onclick="changeBackground('images/bg6.webp')">
    <div class="chapter-icon"><i class="fa-solid fa-star"></i></div>
    <div class="chapter-label">圖八</div>
  </div>
</div>
      <div class="slideContainer">
        <h1>捷運使用情況</h1>
        <div class="page-indicator">
          <div class="bar-container dynamic-bar-container"></div>
        </div>
        <div class="daily-card">
          <div class="template-wrapper add-trip-wrapper">
            <div class="input-group-MRT">
              <label for="mrtStart">選擇起點</label>
              <input list="mrtStationList" id="mrtStart" />
            </div>
            <div class="input-group-MRT">
              <label for="mrtEnd">選擇訖點</label>
              <input list="mrtStationList" id="mrtEnd" />
              <datalist id="mrtStationList"></datalist>
            </div>
            <div class="input-group-MRT">
              <label for="mrtCount">每月搭乘</label>
              <input id="mrtCount" type="number" min="1" />
              <label class="special-label">趟</label>
            </div>
            <button class="mrt-btn" onclick="addMRTTrip()">新增行程</button>
          </div>

          <!-- 這裡一定要加上 id="mrtTripDisplay" -->
          <div class="template-wrapper mrt-trip-list-wrapper" id="mrtTripDisplay">
            <div class="trip-list"><!-- 這裡會塞 trip-item --></div>
            <button class="mrt-btn" onclick="removeMRTTrip()">刪除行程</button>
          </div>
        </div>
      </div>
      <button class="nav-btn prev-btn" onclick="goToPrevScene()">‹</button>
      <button class="nav-btn next-btn" onclick="goToNextScene()">›</button>
    </section>

    <!-- Scene 5: 火車使用情況 -->
    <section id="scene-daily-2-5" class="scene">
<div class="chapter-bar show">
  <div class="chapter-button" onclick="changeBackground('images/圖片\ 1.webp')">
    <div class="chapter-icon"><i class="fa-solid fa-car-side"></i></div>
    <div class="chapter-label">圖一</div>
  </div>
    <div class="chapter-button" onclick="changeBackground('images/background.webp')">
    <div class="chapter-icon"><i class="fa-solid fa-house-chimney"></i></div>
    <div class="chapter-label">圖二</div>
  </div>
  <div class="chapter-button" onclick="changeBackground('images/bg1.webp')">
    <div class="chapter-icon"><i class="fa-solid fa-plane-departure"></i></div>
    <div class="chapter-label">圖三</div>
  </div>
  <div class="chapter-button" onclick="changeBackground('images/bg2.webp')">
    <div class="chapter-icon"><i class="fa-solid fa-drumstick-bite"></i></div>
    <div class="chapter-label">圖四</div>
  </div>
  <div class="chapter-button" onclick="changeBackground('images/bg3.webp')">
    <div class="chapter-icon"><i class="fa-solid fa-shirt"></i></div>
    <div class="chapter-label">圖五</div>
  </div>
  <div class="chapter-button" onclick="changeBackground('images/bg4.webp')">
    <div class="chapter-icon"><i class="fa-solid fa-wifi"></i></div>
    <div class="chapter-label">圖六</div>
  </div>
  <div class="chapter-button" onclick="changeBackground('images/bg5.webp')">
    <div class="chapter-icon"><i class="fa-solid fa-star"></i></div>
    <div class="chapter-label">圖七</div>
  </div>
  <div class="chapter-button" onclick="changeBackground('images/bg6.webp')">
    <div class="chapter-icon"><i class="fa-solid fa-star"></i></div>
    <div class="chapter-label">圖八</div>
  </div>
</div>
      <div class="slideContainer">
        <h1>火車使用情況</h1>
        <div class="page-indicator">
          <div class="bar-container dynamic-bar-container"></div>
        </div>
        <div class="daily-card">
          <div class="template-wrapper add-trip-wrapper">
            <div class="input-group-MRT">
              <label for="trainStart">選擇起點</label>
              <input list="trDistanceMap" id="trainStart" />
            </div>
            <div class="input-group-MRT">
              <label for="trainEnd">選擇訖點</label>
              <input list="trDistanceMap" id="trainEnd" />
              <datalist id="trDistanceMap"></datalist>
            </div>
            <div class="input-group-MRT">
              <label for="trainCount">每月搭乘</label>
              <input id="trainCount" type="number" min="1" />
              <label class="special-label">趟</label>
            </div>
            <button class="mrt-btn" onclick="addTrainTrip()">新增行程</button>
          </div>
          <div class="template-wrapper mrt-trip-list-wrapper">
            <div class="trip-list" id="trainTripList"></div>
            <button class="mrt-btn" onclick="removeTrainTrip()">刪除行程</button>
          </div>
        </div>
      </div>
      <button class="nav-btn prev-btn" onclick="goToPrevScene()">‹</button>
      <button class="nav-btn next-btn" onclick="goToNextScene()">›</button>
    </section>

    <!-- Scene 6: 高鐵使用情況 -->
    <section id="scene-daily-2-6" class="scene">
<div class="chapter-bar show">
  <div class="chapter-button" onclick="changeBackground('images/圖片\ 1.webp')">
    <div class="chapter-icon"><i class="fa-solid fa-car-side"></i></div>
    <div class="chapter-label">圖一</div>
  </div>
    <div class="chapter-button" onclick="changeBackground('images/background.webp')">
    <div class="chapter-icon"><i class="fa-solid fa-house-chimney"></i></div>
    <div class="chapter-label">圖二</div>
  </div>
  <div class="chapter-button" onclick="changeBackground('images/bg1.webp')">
    <div class="chapter-icon"><i class="fa-solid fa-plane-departure"></i></div>
    <div class="chapter-label">圖三</div>
  </div>
  <div class="chapter-button" onclick="changeBackground('images/bg2.webp')">
    <div class="chapter-icon"><i class="fa-solid fa-drumstick-bite"></i></div>
    <div class="chapter-label">圖四</div>
  </div>
  <div class="chapter-button" onclick="changeBackground('images/bg3.webp')">
    <div class="chapter-icon"><i class="fa-solid fa-shirt"></i></div>
    <div class="chapter-label">圖五</div>
  </div>
  <div class="chapter-button" onclick="changeBackground('images/bg4.webp')">
    <div class="chapter-icon"><i class="fa-solid fa-wifi"></i></div>
    <div class="chapter-label">圖六</div>
  </div>
  <div class="chapter-button" onclick="changeBackground('images/bg5.webp')">
    <div class="chapter-icon"><i class="fa-solid fa-star"></i></div>
    <div class="chapter-label">圖七</div>
  </div>
  <div class="chapter-button" onclick="changeBackground('images/bg6.webp')">
    <div class="chapter-icon"><i class="fa-solid fa-star"></i></div>
    <div class="chapter-label">圖八</div>
  </div>
</div>
      <div class="slideContainer">
        <h1>高鐵使用情況</h1>
        <div class="page-indicator">
          <div class="bar-container dynamic-bar-container"></div>
        </div>
        <div class="daily-card">
          <div class="template-wrapper add-trip-wrapper">
            <div class="input-group-MRT">
              <label for="hsrStart">選擇起點</label>
              <input list="hsrStationList" id="hsrStart" />          
            </div>
            <div class="input-group-MRT">
              <label for="hsrEnd">選擇訖點</label>
              <input list="hsrStationList" id="hsrEnd" />
              <datalist id="hsrStationList"></datalist>
            </div>
            <div class="input-group-MRT">
              <label for="hsrCount">每月搭乘</label>
              <input id="hsrCount" type="number" min="1" />
              <label class="special-label">趟</label>
            </div>
            <button class="mrt-btn" onclick="addHsrTrip()">新增行程</button>
          </div>
          <div class="template-wrapper mrt-trip-list-wrapper">
            <div class="trip-list" id="hsrTripList"></div>
            <button class="mrt-btn" onclick="removeHsrTrip()">刪除行程</button>
          </div>
        </div>
      </div>
      <button class="nav-btn prev-btn" onclick="goToPrevScene()">‹</button>
      <button class="nav-btn next-btn" onclick="goToNextScene()">›</button>
    </section>

    <script>
            // 星際聊天室

      const messages = [
        {
          type: "time",
          text: "上午 9:30",
          time: 1000,
        },
        {
          text: "歡我們現在在哪裡？發生了什麼事！",
          from: "user",
          time: 2500,
        },
        {
          text: "我們回到了19世紀初，也就是第一次工業革命的時代。你有沒有聽見？是蒸汽機轟隆轟隆的聲音！",
          from: "cat",
          time: 1500,
        },
        {
          text: "蒸汽機的改良徹底改變了人類社會！燒沒產生蒸汽，蒸汽推動機器，機器拉著人到處跑。",
          from: "cat",
          time: 2500,
        },
        {
          text: "所以這就是我們每天通勤的起點？",
          from: "user",
          time: 1700,
        },
        {
          text: "Bingo！",
          from: "cat",
        },
        {
          text: "交通變快，城市密集，朝九晚五成為日常。自此，碳排悄悄的跟上了科技進步的偉大航道。",
          from: "cat",
        },
        {
          text: "原來~從燒煤開始，人類正式踏入了大排碳時代！",
          from: "user",
        },
      ];

      const chatContainer = document.getElementById("chatContainer");

      function createMessageElement(message) {
        if (message.type === "time") {
          const timeEl = document.createElement("div");
          timeEl.classList.add("story-time-stamp");
          timeEl.textContent = message.text;
          return timeEl;
        }

        const wrapper = document.createElement("div");
        wrapper.classList.add(
          "story-message",
          message.from === "user" ? "story-user-message" : "story-cat-message"
        );

        const avatar = document.createElement("div");
        avatar.classList.add("story-avatar");
        avatar.textContent = message.from === "user" ? "U" : "A";

        const bubble = document.createElement("div");
        bubble.classList.add("story-message-bubble");
        bubble.textContent = message.text;

        wrapper.appendChild(avatar);
        wrapper.appendChild(bubble);
        return wrapper;
      }

    async function playIntroMessages() {
      for (let i = 0; i < messages.length; i++) {
        const el = createMessageElement(messages[i]);
        const messageTime = messages[i].time;
        chatContainer.appendChild(el);
        chatContainer.scrollTop = chatContainer.scrollHeight;
        await new Promise((resolve) => setTimeout(resolve, messageTime));
      }
    }

      window.addEventListener("DOMContentLoaded", playIntroMessages);
        let currentScene = "scene-daily-1";

        function goToNextScene() {
          // 取得目前場景在使用者選取活動中的位置
          const currentIndex = selectedActivities.findIndex(
            (activity) => activityScenes[activity] === currentScene
          );

          // 是最後一個場景 → 導向結果頁
          if (currentIndex === selectedActivities.length - 1) {
            window.location.href = "food.html";
            return;
          }

          // 還有下一頁 → 取得下一個活動的 sceneId，跳轉
          const nextActivity = selectedActivities[currentIndex + 1];
          const nextSceneId = activityScenes[nextActivity];
          if (nextSceneId) {
            goToScene(nextSceneId);
          }
        }

        function goToPrevScene() {
          const currentIndex = selectedActivities.findIndex(
            (activity) => activityScenes[activity] === currentScene
          );

          // 是第一個選擇的活動 → 回到 scene-daily-1
          if (currentIndex === 0) {
            goToScene("scene-daily-1");
            return;
          }

          // 還有上一頁 → 跳到上一個活動頁面
          const prevActivity = selectedActivities[currentIndex - 1];
          const prevSceneId = activityScenes[prevActivity];
          if (prevSceneId) {
            goToScene(prevSceneId);
          }
        }

        function handleFirstSceneNext() {
          // 固定順序
          const fullOrder = [
            "汽車",
            "機車",
            "公車",
            "捷運",
            "火車",
            "高鐵",
          ];

          // 過濾選取的項目並依照固定順序排序
          const sortedActivities = fullOrder.filter((activity) =>
            selectedActivities.includes(activity)
          );

          // 更新陣列
          selectedActivities.length = 0;
          selectedActivities.push(...sortedActivities);

          if (selectedActivities.length === 0) {
            alert("請至少選擇一個交通工具！");
            return;
          }

          const firstScene = activityScenes[selectedActivities[0]];
          goToScene(firstScene);
        }

        const selectedActivities = []; // 儲存選取的項目
        const activityScenes = {
          汽車: "scene-daily-2-1",
          機車: "scene-daily-2-2",
          公車: "scene-daily-2-3",
          捷運: "scene-daily-2-4",
          火車: "scene-daily-2-5",
          高鐵: "scene-daily-2-6",
        };

        function toggleActivity(card, activity) {
          const index = selectedActivities.indexOf(activity);

          if (index === -1) {
            selectedActivities.push(activity);
            card.classList.add("selected");
          } else {
            selectedActivities.splice(index, 1);
            card.classList.remove("selected");
          }

          updatePageIndicators();
        }

        // bar跳轉頁面

        function goToScene(targetId) {
          document.getElementById(currentScene).classList.remove("active");
          document.getElementById(targetId).classList.add("active");
          currentScene = targetId;
          updatePageIndicators();
          updateNavButtonsVisibility();
        }

      function updatePageIndicators() {
        const scene = document.getElementById(currentScene);
        const container = scene.querySelector(".dynamic-bar-container");

        if (!container) return;
        container.innerHTML = "";

        // 👉 1. 先加上「選擇頁」的 bar（永遠是第一個）
        const selectHitArea = document.createElement("div");
        selectHitArea.classList.add("bar-hit-area");

        const selectBar = document.createElement("span");
        selectBar.classList.add("bar");

        // 如果現在頁面是 scene-daily-1，設定 active 狀態
        if (currentScene === "scene-daily-1") {
          selectBar.classList.add("active");
        }

        selectHitArea.appendChild(selectBar);
        selectHitArea.onclick = () => {
          goToScene("scene-daily-1");
          updateBarActive(0); // 第一個 bar 是 index 0
        };
        container.appendChild(selectHitArea);

        // 👉 2. 依據選到的 activity 加上對應 bar
        selectedActivities.forEach((activity, idx) => {
          const sceneId = activityScenes[activity];
          if (!sceneId) return;

          const hitArea = document.createElement("div");
          hitArea.classList.add("bar-hit-area");

          const bar = document.createElement("span");
          bar.classList.add("bar");

          // 注意：因為第一個 bar 是選擇頁，這邊是 idx+1
          if (currentScene === sceneId) {
            bar.classList.add("active");
          }

          hitArea.appendChild(bar);

          hitArea.onclick = () => {
            goToScene(sceneId);
            updateBarActive(idx + 1);
          };

          container.appendChild(hitArea);
        });
      }

      function updateNavButtonsVisibility() {
        const sceneEl = document.getElementById(currentScene);

        // 取得按鈕（用 querySelector 找當前 scene 裡的按鈕）
        const prevBtn = sceneEl.querySelector(".prev-btn");
        const nextBtn = sceneEl.querySelector(".next-btn");

        // 全部先隱藏
        document.querySelectorAll(".prev-btn, .next-btn").forEach(btn => {
          btn.style.display = "none";
        });

        // 這個 scene 有的才顯示
        if (prevBtn) prevBtn.style.display = "block";
        if (nextBtn) nextBtn.style.display = "block";
      }


      function updateBarActive(activeIndex) {
        const scene = document.getElementById(currentScene);
        const container = scene.querySelector(".dynamic-bar-container");
        if (!container) return;

        const bars = container.querySelectorAll(".bar-hit-area .bar");
        bars.forEach((bar, idx) => {
          if (idx === activeIndex) {
            bar.classList.add("active");
          } else {
            bar.classList.remove("active");
          }
        });
      }

      function goToScene(targetId) {
        document.getElementById(currentScene).classList.remove("active");
        document.getElementById(targetId).classList.add("active");
        currentScene = targetId;
        updatePageIndicators();
        updateNavButtonsVisibility();
      }

      function updateNavButtonsVisibility() {
        const sceneEl = document.getElementById(currentScene);

        const prevBtn = sceneEl.querySelector(".prev-btn");
        const nextBtn = sceneEl.querySelector(".next-btn");

        document.querySelectorAll(".prev-btn, .next-btn").forEach((btn) => {
          btn.style.display = "none";
        });

        if (prevBtn) prevBtn.style.display = "block";
        if (nextBtn) nextBtn.style.display = "block";
      }

      function updatePageIndicators() {
        const scene = document.getElementById(currentScene);
        const container = scene.querySelector(".dynamic-bar-container");

        if (!container) return;
        container.innerHTML = "";

        // ➤ 第一個 bar：選擇交通工具頁面
        const selectHitArea = document.createElement("div");
        selectHitArea.classList.add("bar-hit-area");

        const selectBar = document.createElement("span");
        selectBar.classList.add("bar");

        if (currentScene === "scene-daily-1") {
          selectBar.classList.add("active");
        }

        selectHitArea.appendChild(selectBar);
        selectHitArea.onclick = () => {
          goToScene("scene-daily-1");
          updateBarActive(0);
        };
        container.appendChild(selectHitArea);
          // 👉 2. 依據選到的 activity 加上對應 bar
        selectedActivities.forEach((activity, idx) => {
          const sceneId = activityScenes[activity];
          if (!sceneId) return;

          const hitArea = document.createElement("div");
          hitArea.classList.add("bar-hit-area");

          const bar = document.createElement("span");
          bar.classList.add("bar");

          // 注意：因為第一個 bar 是選擇頁，這邊是 idx+1
          if (currentScene === sceneId) {
            bar.classList.add("active");
          }

          hitArea.appendChild(bar);

          hitArea.onclick = () => {
            goToScene(sceneId);
            updateBarActive(idx + 1);
          };

          container.appendChild(hitArea);
        });
      }

      function updateBarActive(activeIndex) {
        const scene = document.getElementById(currentScene);
        const container = scene.querySelector(".dynamic-bar-container");
        if (!container) return;

        const bars = container.querySelectorAll(".bar-hit-area .bar");
        bars.forEach((bar, idx) => {
          bar.classList.toggle("active", idx === activeIndex);
        });
      }

      document.addEventListener("DOMContentLoaded", () => {
        currentScene = "scene-daily-1";
        updatePageIndicators();
        updateNavButtonsVisibility();
      });

// 汽車 & 機車：燃料切換 & 方法切換
    function setupToggle(fuelId, methodId, oilLeftId, oilRightId, elecLeftId, elecRightId, paneLeftId, paneRightId) {
          const fuelToggle   = document.getElementById(fuelId);
          const methodToggle = document.getElementById(methodId);
          const oilLeft      = document.getElementById(oilLeftId);
          const oilRight     = document.getElementById(oilRightId);
          const elecLeft     = document.getElementById(elecLeftId);
          const elecRight    = document.getElementById(elecRightId);
          const paneLeft     = document.getElementById(paneLeftId);
          const paneRight    = document.getElementById(paneRightId);

          function updateFuel() {
              const isElec = fuelToggle.checked;
              oilLeft.classList.toggle("hidden", isElec);
              oilRight.classList.toggle("hidden", isElec);
              elecLeft.classList.toggle("hidden", !isElec);
              elecRight.classList.toggle("hidden", !isElec);
          }
          
          function updateMethod() {
              const isVol = methodToggle.checked;
              paneLeft.classList.toggle("inactive", isVol);
              paneRight.classList.toggle("inactive", !isVol);
          }
          
          fuelToggle.addEventListener("change", () => { updateFuel(); updateMethod(); });
          methodToggle.addEventListener("change", updateMethod);
          updateFuel();
          updateMethod();
      }

// 距離資料容器
mrtDistanceMap = {}, trDistanceMap = {}, hsrDistanceMap = {};

// 初始化
document.addEventListener("DOMContentLoaded", () => {
  // 設定切換開關
  setupToggle("fuelToggle", "methodToggle", "oil-left", "oil-right", "electric-left", "electric-right", "pane-left", "pane-right");
  setupToggle("fuelToggle4", "methodToggle4", "oil-left4", "oil-right4", "electric-left4", "electric-right4", "pane-left4", "pane-right4");

//汽車汽油選項

let oilData = {
  "92無鉛": "92無鉛",
  "95無鉛": "95無鉛",
  "98無鉛": "98無鉛",
  "柴油": "柴油"
};

const carOilList = document.getElementById("car-oilList");

for (let key in oilData) {
  const option = document.createElement("option");
  option.value = oilData[key];
  carOilList.appendChild(option);
}

//機車汽油選項

const motorcycleOilList = document.getElementById("motorcycle-oilList");

for (let key in oilData) {
  const option = document.createElement("option");
  option.value = oilData[key];
  motorcycleOilList.appendChild(option);
}

//汽車選項

let carData = {
  "小型房車": "小型房車", 
  "中型房車": "中型房車", 
  "大型房車": "大型房車", 
  "小型休旅車": "小型休旅車", 
  "中型休旅車": "中型休旅車", 
  "大型休旅車": "大型休旅車"
}

const carList = document.getElementById("carList");

for (let key in carData) {
  const option = document.createElement("option");
  option.value = carData[key];
  carList.appendChild(option);
}

// 將 JSON 資料分開讀取

  fetch("./data/mrtDistanceMap.json").then(r => r.json()).then(data => {
    mrtDistanceMap = data;
    const dl = document.getElementById("mrtStationList");
    if (dl) {
      new Set(Object.keys(data).flatMap(k => k.split("_"))).forEach(st => {
        const o = document.createElement("option");
        o.value = st;
        dl.appendChild(o);
      });
    }
  }).catch(err => console.log("MRT data not loaded:", err));

  fetch("./data/trDistanceMap.json").then(r => r.json()).then(data => {
    trDistanceMap = data;
    const dl = document.getElementById("trDistanceMap");
    if (dl) {
      const stations = new Set();
      if (typeof data === 'object') {
        Object.keys(data).forEach(key => {
          stations.add(key);
          if (typeof data[key] === 'object') {
            Object.keys(data[key]).forEach(subKey => stations.add(subKey));
          }
        });
      }
      stations.forEach(st => {
        const o = document.createElement("option");
        o.value = st;
        dl.appendChild(o);
      });
    }
  }).catch(err => console.log("Train data not loaded:", err));

  fetch("./data/hsrDistanceMap.json").then(r => r.json()).then(data => {
    hsrDistanceMap = data;
    const dl = document.getElementById("hsrStationList");
    if (dl) {
      new Set(Object.keys(data).flatMap(k => k.split("_"))).forEach(st => {
        const o = document.createElement("option");
        o.value = st;
        dl.appendChild(o);
      });
    }
  }).catch(err => console.log("HSR data not loaded:", err));

  setupTripListSelection();
});

// ===== 更新選取資訊 =====
function updateSelectionInfo(container) {
  // 移除選取資訊顯示功能，僅保留函數結構以維持兼容性
}

function setupTripListSelection() {
  const tripContainers = [
    "#mrtTripDisplay .trip-list", 
    "#trainTripList",
    "#hsrTripList"
  ];

  tripContainers.forEach(selector => {
    const container = document.querySelector(selector);
    if (container && !container.hasAttribute('data-selection-setup')) {
      // 綁定點擊事件
      container.addEventListener("click", e => {
        const item = e.target.closest(".trip-item");
        if (!item) return;
        
        // 阻止事件冒泡
        e.stopPropagation();
        e.preventDefault();
        
        // 切換選取狀態（多選模式）
        item.classList.toggle("selected");
      });
      
      // 標記已設置
      container.setAttribute('data-selection-setup', 'true');
    }
  });
}

function makeSelectable(item) {
  item.classList.add("trip-item");
  
  // 確保項目可以被點擊
  item.style.cursor = "pointer";
  item.style.userSelect = "none";
  
  return item;
}

// ===== 通用新增行程函數 =====
function addTrip(map, startId, endId, countId, displaySelector) {
  const s = document.getElementById(startId).value.trim();
  const e = document.getElementById(endId).value.trim();
  const c = parseInt(document.getElementById(countId).value, 10) || 0;
  
  if (!s || !e || c <= 0) {
    return alert("請填寫完整的起訖點並輸入趟數");
  }
  
  const dist = map[`${s}_${e}`];
  if (dist === undefined) return alert("請選擇正確的起訖點並輸入趟數");

  const item = document.createElement("div");
  item.innerHTML = `<span class="trip-item-text">${s} → ${e} ${c}趟</span>`;
  makeSelectable(item);
  
  const listContainer = document.querySelector(`${displaySelector} .trip-list`);
  if (listContainer) {
    listContainer.appendChild(item);
  }
}

// ===== 通用刪除行程函數 =====
function deleteTrip(displaySelector) {
  const list = document.querySelector(`${displaySelector} .trip-list`) || document.querySelector(displaySelector);
  if (!list) return alert("找不到行程列表");
  
  const selectedItems = list.querySelectorAll(".trip-item.selected");
  
  if (selectedItems.length > 0) {
    // 刪除所有選中的項目
    selectedItems.forEach(item => item.remove());
  } else if (list.lastElementChild && list.lastElementChild.classList.contains("trip-item")) {
    // 如果沒有選中項目，刪除最後一個
    list.lastElementChild.remove();
  } else {
    alert("沒有行程可刪除");
  }
}

// MRT 行程管理
function addMRTTrip() {
  addTrip(mrtDistanceMap, "mrtStart", "mrtEnd", "mrtCount", "#mrtTripDisplay");
  
  document.getElementById("mrtStart").value = "";
  document.getElementById("mrtEnd").value = "";
  document.getElementById("mrtCount").value = "";
}

function removeMRTTrip() {
  deleteTrip("#mrtTripDisplay");
}

// 火車行程管理
function addTrainTrip() {
  const s = document.getElementById("trainStart").value.trim();
  const e = document.getElementById("trainEnd").value.trim();
  const c = parseInt(document.getElementById("trainCount").value, 10) || 0;
  
  if (!s || !e || c <= 0) {
    return alert("請填寫完整的起訖點並輸入趟數");
  }
  
  if (trDistanceMap[s] === undefined) {
    const availableStations = Object.keys(trDistanceMap).filter(station => 
      station.toLowerCase().includes(s.toLowerCase()) || 
      s.toLowerCase().includes(station.toLowerCase())
    );
    return alert(`找不到車站 "${s}"。\n可能的車站名稱: ${availableStations.slice(0, 5).join(', ')}${availableStations.length > 5 ? '...' : ''}`);
  }
  
  if (trDistanceMap[e] === undefined) {
    const availableStations = Object.keys(trDistanceMap).filter(station => 
      station.toLowerCase().includes(e.toLowerCase()) || 
      e.toLowerCase().includes(station.toLowerCase())
    );
    return alert(`找不到車站 "${e}"。\n可能的車站名稱: ${availableStations.slice(0, 5).join(', ')}${availableStations.length > 5 ? '...' : ''}`);
  }
  
  const startKm = trDistanceMap[s];
  const endKm = trDistanceMap[e];
  const dist = Math.abs(endKm - startKm).toFixed(1);

  const item = document.createElement("div");
  item.innerHTML = `<span class="trip-item-text">${s} → ${e} ${c}趟</span>`;
  makeSelectable(item);
  
  const listContainer = document.getElementById("trainTripList");
  listContainer.appendChild(item);
  
  document.getElementById("trainStart").value = "";
  document.getElementById("trainEnd").value = "";
  document.getElementById("trainCount").value = "";
}

function removeTrainTrip() {
  const list = document.getElementById("trainTripList");
  if (!list) return alert("找不到行程列表");
  
  const selectedItems = list.querySelectorAll(".trip-item.selected");
  
  if (selectedItems.length > 0) {
    selectedItems.forEach(item => item.remove());
  } else if (list.lastElementChild && list.lastElementChild.classList.contains("trip-item")) {
    list.lastElementChild.remove();
  } else {
    alert("沒有行程可刪除");
  }
}

// 高鐵行程管理
function addHsrTrip() {
  const s = document.getElementById("hsrStart").value.trim();
  const e = document.getElementById("hsrEnd").value.trim();
  const c = parseInt(document.getElementById("hsrCount").value, 10) || 0;
  
  if (!s || !e || c <= 0) {
    return alert("請填寫完整的起訖點並輸入趟數");
  }
  
  const dist = hsrDistanceMap[`${s}_${e}`] || hsrDistanceMap[`${e}_${s}`];
  if (dist === undefined) return alert("請選擇正確的起訖點並輸入趟數");

  const item = document.createElement("div");
  item.innerHTML = `<span class="trip-item-text">${s} → ${e} ${c}趟</span>`;
  makeSelectable(item);
  
  const listContainer = document.getElementById("hsrTripList");
  listContainer.appendChild(item);
  
  document.getElementById("hsrStart").value = "";
  document.getElementById("hsrEnd").value = "";
  document.getElementById("hsrCount").value = "";
}

function removeHsrTrip() {
  const list = document.getElementById("hsrTripList");
  if (!list) return alert("找不到行程列表");
  
  const selectedItems = list.querySelectorAll(".trip-item.selected");
  
  if (selectedItems.length > 0) {
    selectedItems.forEach(item => item.remove());
    updateSelectionInfo(list);
  } else if (list.lastElementChild && list.lastElementChild.classList.contains("trip-item")) {
    list.lastElementChild.remove();
    updateSelectionInfo(list);
  } else {
    alert("沒有行程可刪除");
  }
}

//顯示問題

const sendButton = document.getElementById("send-button");

function StartQuestionnaire() {
    document.querySelector(".story-body").style.display = "none";
    document.querySelector("body").style.display = "flex";
    document.querySelector(".scene-1").classList.add("active");
}

sendButton.addEventListener("click", () => {
    StartQuestionnaire();
});

customElements.define('chapter-bar', ChapterBar);

const currentPage = window.location.pathname.split('/').pop();
document.querySelectorAll('.chapter-button').forEach(button => {
const href = button.getAttribute('onclick')?.match(/'(.*?)'/)?.[1];
if (href && currentPage === href) {
    button.classList.add('active');
}
});

  function changeBackground(imageUrl) {
    document.documentElement.style.backgroundImage = `url('${imageUrl}')`;
  }
</script>

  </body>
</html>
